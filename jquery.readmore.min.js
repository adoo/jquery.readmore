/** 
 * jquery.readmore
 * ===============
 * @date 9 dec 2012
 * @author Ado B (echo@ado.io)
 * @url https://github.com/adoo/jquery.readmore
 */
(function(e){e.fn.readmore=function(m){function n(a,b,c,f){var d=b.clone();d.appendTo(a).bind("click",function(h){d.remove();a.find("."+c).filter(":hidden").animate({opacity:"toggle"},600);f();h.preventDefault();return false})}function o(a,b,c,f){b=a.find("."+b);for(var d=a.outerHeight(),h=false,j,i,k=b.length;k--;){j=e(b[k]);i=j.find("*").length;i=i!=0&&j.find(":hidden").length==i;if(d>c&&(d>f||d==0||i)){j.hide();d=a.outerHeight();h=true}else break}return h}function p(a,b){var c=e(b),f=c.prop("tagName")||
"";c=c.children(g.skip_elements.join(",")).length>0;return!(e.inArray(f.toLowerCase(),g.skip_elements)>-1||c)}function q(a,b){var c=e(b),f=false,d,h=g.ignore_children.join();c.parentsUntil(r).each(function(){d=e(this).prop("tagName")||"";if(h.indexOf(d.toLowerCase())>-1)f=true});return!f}function s(a,b,c){var f,d;a=a.find("*");var h,j,i,k,l=false;if(g.skip_elements.length>0)a=a.filter(p);if(g.ignore_children.length>0)a=a.filter(q);a.addClass(b);a.contents().each(function(){d=e(this);j=this.nodeType===
3;i=e.trim(d.text())=="";h=d.parent().prop("tagName")||"";k=e.inArray(h.toLowerCase(),c)>-1;if(j&&!i&&!k){f='<span class="'+b+'">'+d.text().replace(g.split_using,'$1</span><span class="'+b+'">')+"</span>";f=f.replace('<span class="'+b+'"></span>',"");d.replaceWith(e(f));l=true}});return l}var r,g=e.extend({minheight:50,maxheight:200,hide_me_classname:"hideme",ignore_children:["a","i","strong","h1","h2","h3"],skip_elements:[],split_using:/(\.|,|-|\u2013|\?|\!)/g,readmore_link:e('<a href="" class="read-more">Read more</a>')},
m);return this.each(function(){var a=false,b=false,c=e(this);if(a===false)a=s(c,g.hide_me_classname,g.ignore_children);if(b===false&&a===true)b=o(c,g.hide_me_classname,g.minheight,g.maxheight);b===true&&a===true&&n(c,g.readmore_link,g.hide_me_classname,function(){b=false})})}})(jQuery);
